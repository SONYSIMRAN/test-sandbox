<template>
    <div class="bg-light dxAppPage">
        <lightning-spinner if:true={isLoading}></lightning-spinner>
        <c-dx-header  
            package-data={packageData} 
            card-view={cardView} 
            kanban-view={kanbanView} 
            list-view={listView}
            button-package-dep={buttonPackageDep} 
            button-sandbox-code-size={buttonSandboxCodeSize} 
            selected-sandbox={selectedSandbox} 
            sandbox-options={sandboxOptions}  
            onsandboxchange={handleSandboxChange}
            button-metrics-dashboard={buttonMetricsDashboard} 
            button-package-sorting={buttonPackageSorting}
            select-sandbox={selectSandbox} 
            sandbox-list={sandboxList} 
            onchildmethod={getSandbox}
            onpackagesorting={packageSorting} 
            onselectedsourcechange={handleSelectedSourceChange} 
            labels={labels}>
        </c-dx-header>

        <template if:true={isDataAvailable}>
            <!-- Filters Section for Metadata Types and Reset Button -->
            <div class="controls-container">
                <div class="filters-section">
                    <p class="filters-title">Filters</p>
                    <template for:each={filterValues} for:item="filter">
                        <div key={filter.type} class="slds-form-element filter-item">
                            <lightning-input type="checkbox"
                                label={filter.type}
                                data-filter={filter.type}
                                checked={filter.checked}
                                onchange={handleFilterChange}>
                            </lightning-input>
                        </div>
                    </template>
                </div>
                <!-- Reset Button in place of External Dep -->
                <lightning-button label="Reset" class="reset-button" onclick={resetGraph}></lightning-button>
            </div>
            
            <c-dx-vis-dependency-graph dependencies={filteredDependencies}></c-dx-vis-dependency-graph>
        </template>

        <template if:false={isDataAvailable}>
            <c-dx-vis-no-data-sfdx></c-dx-vis-no-data-sfdx>
        </template>

        <c-dx-footer></c-dx-footer>
    </div>
</template>